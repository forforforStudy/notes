# 单元测试

> 敏捷开发中最重要的测试驱动开发, 单元测试层面的一个重要指标就是测试覆盖率. 指标本身不是目的, 只是达到目的的一种辅助.

## **sinon** 概念

> [译-Sinon入门:利用Mocks，Spies和Stubs完成javascript测试](http://blog.kazaff.me/2016/11/11/译-Sinon入门：利用Mocks，Spies和Stubs完成javascript测试/)

> [https://zhuanlan.zhihu.com/p/27986118](https://zhuanlan.zhihu.com/p/27986118) 这里提到一点, 代码覆盖率工具的实现方式: 代码转换生成语法树后在对应的位置注入统计代码
> 执行后根据注入的统计变量, 统计执行次数等最后生成测试报告.

在复杂的逻辑或者依赖 IO, 网络异步或者一些直接方法难以测试时, 就可以使用 `sinon` 简化复杂代码的测试了

通过创建测试替身, 替换代码中的依赖的一些函数或者类, 模拟出我们代码需要的结果让难以测试的代码逻辑被执行.

测试替身可以分成三种类型: 

1. Spy

提供函数的调用信息, 不改变函数的行为.

2. Stub

提供函数调用信息, 让被包裹的函数返回任何我们需要的行为

3. Mock

通过组合 spy 和 stub 替换一个完整的对象.s